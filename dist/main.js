(()=>{function e(){const e=window.getSelection().toString(),o=document.querySelector("#booqs-dict-search-keyword").textContent;if(""!=e&&o!=e&&e.length<50){let o=document.querySelector("#booqs-dict-search-form");o.value=e,console.log(o.value),t(e)}}function t(e){document.querySelector("#booqs-dict-search-keyword").textContent=e,document.querySelector("#search-booqs-dict-results").innerHTML='<div class="center"><div class="lds-ripple-booqs-dict"><div></div><div></div></div></div>';let i=encodeURIComponent(e);fetch("https://www.booqs.net/api/v1/extension/search?keyword="+i,{method:"GET"}).then((e=>e.json())).then((e=>{!function(e){console.log(e.data);let i=document.querySelector("#search-booqs-dict-results");i.innerHTML="",chrome.storage.local.get(["booqsDictToken"],(function(s){let r=s.booqsDictToken;if(null!=e.data)e.data.forEach((function(e,t,s){console.log(e,t);let c,a=function(e){if(null==e)return'<div class="booqs-dict-word-tags-wrapper"></div>';let t=e.split(","),o=[];if(t.includes("ngsl")){let e='<a href="https://www.booqs.net/ja/chapters/c63ab6e5" target="_blank" rel="noopener" class="booqs-dict-word-tag"><i class="fal fa-tag"></i>åŸºç¤è‹±å˜èª</a>';o.push(e)}if(t.includes("nawl")){let e='<a href="https://www.booqs.net/ja/chapters/5cedf1da" target="_blank" rel="noopener" class="booqs-dict-word-tag"><i class="fal fa-tag"></i>å­¦è¡“é »å‡ºèª</a>';o.push(e)}if(t.includes("tsl")){let e='<a href="https://www.booqs.net/ja/chapters/26c399f0" target="_blank" rel="noopener" class="booqs-dict-word-tag"><i class="fal fa-tag"></i>TOEICé »å‡ºèª</a>';o.push(e)}if(t.includes("bsl")){let e='<a href="https://www.booqs.net/ja/chapters/4d46ce7f" target="_blank" rel="noopener" class="booqs-dict-word-tag"><i class="fal fa-tag"></i>ãƒ“ã‚¸ãƒã‚¹é »å‡ºèª</a>';o.push(e)}if(t.includes("phrase")){let e='<a href="https://www.booqs.net/ja/chapters/c112b566" target="_blank" rel="noopener" class="booqs-dict-word-tag"><i class="fal fa-tag"></i>é »å‡ºè‹±ç†Ÿèª</a>';o.push(e)}if(t.includes("phave")){let e='<a href="https://www.booqs.net/ja/chapters/3623e0d5" target="_blank" rel="noopener" class="booqs-dict-word-tag"><i class="fal fa-tag"></i>é »å‡ºå¥å‹•è©</a>';o.push(e)}return`<div class="booqs-dict-word-tags-wrapper">${o.join("")}</div>`}(e.tags),d=`<div class="booqs-dict-entry"><span>${e.entry}</span><button class="booqs-dict-speech-btn"><i class="fas fa-volume-up"></i></button></div>`,l='<div class="booqs-dict-meaning">'+e.meaning+"</div>",u='<div class="booqs-dict-explanation">'+function(e){let t=e.replace(/\r?\n/g,"<br>").split(/(\[{2}.*?\]{2})/),o=[];return t.forEach((function(e,t,n){if(null==e.match(/\[{2}.+\]{2}/))o.push(e);else{let t;t=null==(e=(e=e.replace(/\[{2}/g,"").replace(/\]{2}/g,"")).split(/\|/,2))[1]?`<a class="booqs-notation-link" data-value="${e[0]}">${e[0]}</a>`:`<a class="booqs-notation-link" data-value="${e[1]}">${e[0]}</a>`,o.push(t)}})),o.join("")}(e.explanation)+"</div>",b=`https://www.booqs.net/ja/words/${e.id}`;c=r?`<div class="booqs-dict-async-review-btn booqs-dict-review-btn" id="booqs-dict-review-${e.id}">å¾©ç¿’ã™ã‚‹</div><div class="booqs-dict-review-form" id="booqs-dict-review-form-${e.id}"></div>`:`<a href="${b}?type=review" target="_blank" rel="noopener"><div class="booqs-dict-review-btn" id="booqs-dict-review-btn-${e.id}">å¾©ç¿’ã™ã‚‹</div></a>`;let m=a+d+l+u+c+`<a href="${b+"/edit"}" target="_blank" rel="noopener" class="booqs-dict-link-to-improve">ã“ã®é …ç›®ã‚’æ”¹å–„ã™ã‚‹</a>`;i.insertAdjacentHTML("beforeend",m),r&&function(e,t){let i=document.querySelector("#booqs-dict-review-"+t),s=i.nextSibling;i.addEventListener("click",(function(){s.innerHTML='<div class="center"><div class="lds-ripple-booqs-dict"><div></div><div></div></div></div>',function(e){let t=chrome.runtime.connect({name:"renderReviewForm"});t.postMessage({action:"renderReviewForm",wordId:e}),t.onMessage.addListener((function(e){if(e.data){let t=e.data,i=t.word_id;document.querySelector("#booqs-dict-review-form-"+i).innerHTML=function(e){let t,i=e.word_id;return t=e.reminder_id?`\n        <div class="boqqs-dict-reminder-status">\n        <p>å¾©ç¿’äºˆå®šï¼š${e.review_day}</p>\n        <p>å¾©ç¿’è¨­å®šï¼š${o(e.setting)}ã«å¾©ç¿’ã™ã‚‹</p>  \n        <div class="booqs-dict-destroy-review-btn" id="booqs-dict-destroy-review-btn-${i}"><i class="far fa-trash"></i> å¾©ç¿’è¨­å®šã‚’å‰Šé™¤ã™ã‚‹</div>\n        </div>      \n<div class="booqs-dict-select-form cp_sl01">\n<select id="booqs-dict-select-form-${i}" required>\n\t${n(e)}\n</select>\n</div>\n<button class="booqs-dict-submit-review-btn" id="booqs-dict-update-review-btn-${i}">è¨­å®šã™ã‚‹</button>\n<div class="booqs-dict-recommend-premium" id="booqs-dict-recommend-premium-${i}"></div>`:`      \n<div class="booqs-dict-select-form cp_sl01">\n<select id="booqs-dict-select-form-${i}" required>\n\t${n(e)}\n</select>\n</div>\n<button class="booqs-dict-submit-review-btn" id="booqs-dict-create-review-btn-${i}">è¨­å®šã™ã‚‹</button>\n<div class="booqs-dict-recommend-premium" id="booqs-dict-recommend-premium-${i}"></div>`,t}(t),function(e){let t=e.word_id;console.log(t);let n=e.quiz_id;e.reminder_id?(function(e,t){let n=document.querySelector("#booqs-dict-update-review-btn-"+e);n.addEventListener("click",(function(){n.textContent="è¨­å®šä¸­...";let i=document.querySelector("#booqs-dict-select-form-"+e).value,s=chrome.runtime.connect({name:"updateReminder"});s.postMessage({action:"updateReminder",quizId:t,settingNumber:i}),s.onMessage.addListener((function(e){let t=e.data;if(!t.word_id)return void(n.textContent="ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚");let i=document.querySelector("#booqs-dict-review-form-"+t.word_id);i.innerHTML="",i.previousSibling.textContent=`${o(t.setting)}ã«å¾©ç¿’ã™ã‚‹`}))}))}(t,n),function(e,t){let o=document.querySelector(`#booqs-dict-destroy-review-btn-${e}`);o.addEventListener("click",(function(){o.textContent="è¨­å®šä¸­...";let e=chrome.runtime.connect({name:"destroyReminder"});e.postMessage({action:"destroyReminder",quizId:t}),e.onMessage.addListener((function(e){let t=e.data;if(!t.word_id)return void(submitBtn.textContent="ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚");let o=document.querySelector("#booqs-dict-review-form-"+t.word_id);o.innerHTML="",o.previousSibling.textContent="å¾©ç¿’ã™ã‚‹"}))}))}(t,n)):function(e,t){let n=document.querySelector("#booqs-dict-create-review-btn-"+e);n.addEventListener("click",(function(){n.textContent="è¨­å®šä¸­...";let i=document.querySelector("#booqs-dict-select-form-"+e).value,s=chrome.runtime.connect({name:"createReminder"});s.postMessage({action:"createReminder",quizId:t,settingNumber:i}),s.onMessage.addListener((function(e){let t=e.data;if(!t.word_id)return void(n.textContent="ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚");let i=document.querySelector("#booqs-dict-review-form-"+t.word_id);i.innerHTML="",i.previousSibling.textContent=`${o(t.setting)}ã«å¾©ç¿’ã™ã‚‹`}))}))}(t,n),"false"==e.premium&&function(e){const t=document.querySelector(`#booqs-dict-recommend-premium-${e}`),o=t.previousElementSibling,n=document.querySelector(`#booqs-dict-select-form-${e}`);let i=Number(n.value);const s='<p>ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¼šå“¡ã«ãªã‚‹ã“ã¨ã§ã€å¾©ç¿’ã‚’è‡ªç”±ã«è¨­å®šã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼</p>\n    <p><a href="https://www.booqs.net/ja/select_plan" target="_blank" rel="noopener"><i class="far fa-crown"></i> ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³ã®è©³ç´°ã‚’è¦‹ã‚‹</a></p>';0!=i&&(o.classList.add("hidden"),t.innerHTML=s),n.addEventListener("change",(function(){i=Number(this.value),0==i?(o.classList.remove("hidden"),t.innerHTML=""):(o.classList.add("hidden"),t.innerHTML=s)}))}(t)}(t)}}))}(t)}))}(0,e.id)})),function(e){const o=e.querySelectorAll(".booqs-notation-link"),n=document.querySelector("#booqs-dict-search-form");o.forEach((function(e){e.addEventListener("click",(function(e){let o=e.target.dataset.value;return n.value!=o&&(n.value=o,t(o)),!1}))}))}(i),function(e){const t=e.querySelectorAll(".booqs-dict-speech-btn");speechSynthesis.getVoices(),t.forEach((function(e){e.addEventListener("click",(function(t){speechSynthesis.cancel();let o=e.previousElementSibling.textContent;console.log(o);let n=new SpeechSynthesisUtterance,i=speechSynthesis.getVoices().find((function(e){return"Samantha"===e.name}));return n.voice=i,console.log(i),n.lang="en-US",n.volume=1,n.rate=1,n.pitch=1,n.text=o,speechSynthesis.speak(n),!1}))}))}(i);else{let e=document.querySelector("#booqs-dict-search-keyword").textContent;e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;");let t=`<div class="booqs-dict-meaning" style="margin: 24px 0;">${e}ã¯è¾æ›¸ã«ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</div><a href="https://www.booqs.net/ja/words/new?dict_uid=c6bbf748&text=${e}" target="_blank" rel="noopener"><div class="booqs-dict-review-btn" style="font-weight: bold;">è¾æ›¸ã«ç™»éŒ²ã™ã‚‹</div></a>`;i.insertAdjacentHTML("afterbegin",t)}}))}(e)})).catch((e=>{console.log(e)}))}function o(e){let t="";switch(e=Number(e)){case 0:t="æ˜æ—¥";break;case 1:t="3æ—¥å¾Œ";break;case 2:t="ï¼‘é€±é–“å¾Œ";break;case 3:t="ï¼’é€±é–“å¾Œ";break;case 4:t="ï¼“é€±é–“å¾Œ";break;case 5:t="ï¼‘ãƒ¶æœˆå¾Œ";break;case 6:t="ï¼’ãƒ¶æœˆå¾Œ";break;case 7:t="ï¼“ãƒ¶æœˆå¾Œ";break;case 8:t="ï¼–ãƒ¶æœˆå¾Œ";break;case 9:t="1å¹´å¾Œ"}return t}function n(e){console.log(e),console.log(e.premium);let t=0;e.setting&&(t=Number(e.setting));let n="";for(let i=0;i<10;i++){let s="";0!=i&&"false"==e.premium&&(s="ğŸ”’ "),n+=i==t?`<option value="${i}" selected>${s}${o(i)}ã«å¾©ç¿’ã™ã‚‹</option>`:`<option value="${i}">${s}${o(i)}ã«å¾©ç¿’ã™ã‚‹</option>`}return n}chrome.runtime.onMessage.addListener((function(o,n,i){"Action"==o&&function(){let o=document.getElementById("booqs-dict-extension-wrapper");if(null==o){jsFrame=new JSFrame({horizontalAlign:"right"});const i='\n        <div id="booqs-dict-extension-wrapper">\n        <a>\n        <div id="booqs-dict-logged-in-user">ã€€</div>\n        </a>\n        <form method="get" action=""><input type="text" name="keyword" id="booqs-dict-search-form"></form>\n        <div id="booqs-dict-search-status">\n        "<span id="booqs-dict-search-keyword"></span>"<span id="booqs-dict-search-status-text">ã®æ¤œç´¢çµæœ</span>\n        </div>\n        <div id="search-booqs-dict-results"></div>\n        </div>';let s=jsFrame.create({name:"booqs-dict-window",title:"BooQs Dictionary",width:320,height:480,movable:!0,resizable:!0,appearanceName:"material",appearanceParam:{border:{shadow:"2px 2px 10px  rgba(0, 0, 0, 0.5)",width:0,radius:6},titleBar:{name:"booqs-dict-window-bar",color:"white",background:"#273132",leftMargin:16,height:30,fontSize:14,buttonWidth:36,buttonHeight:16,buttonColor:"white",buttons:[{fa:"fas fa-times",name:"closeButton",visible:!0}]}},style:{overflow:"auto"},html:i});s.setPosition(-20,100,["RIGHT_TOP"]),s.show();let r=document.querySelector("#booqs-dict-search-form");document.addEventListener("mouseup",(function(t){e(),t.stopPropagation()}),!1),(n=r).addEventListener("keyup",(function(){let e=n.value,o=document.querySelector("#booqs-dict-search-keyword").textContent;setTimeout((()=>{let n=document.querySelector("#booqs-dict-search-form").value;e==n&&e!=o&&e.length<50&&t(e)}),500)})),function(e){e.addEventListener("keydown",(function(e){"Enter"==e.key&&e.preventDefault()}))}(r),o=s.$("#booqs-dict-extension-wrapper"),o.parentNode.parentNode.parentNode.parentNode.parentNode.style.zIndex="2147483647",e(),function(){let e=chrome.runtime.connect({name:"inspectCurrentUser"});e.postMessage({action:"inspectCurrentUser"}),e.onMessage.addListener((function(e){let t=document.querySelector("#booqs-dict-logged-in-user");e.data?chrome.storage.local.get(["booqsDictUserName"],(function(e){t.innerHTML=`<i class="fal fa-user"></i> ${e.booqsDictUserName}`})):t.innerHTML='<i class="fal fa-user"></i> ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹'})),document.querySelector("#booqs-dict-logged-in-user").addEventListener("click",(function(){chrome.runtime.sendMessage({action:"openOptionsPage"})}))}()}else o.parentNode.parentNode.parentNode.parentNode.parentNode.remove();var n}()}))})();